---
import PageLayout from '../../layouts/PageLayout.astro';
import { getLangFromUrl, useTranslations, getLocalizedPath } from '../../i18n/utils';
import { getLanguagePaths } from '../../i18n/static-paths';
import { loadTranslations } from '../../i18n/index';
import ChatWindow from '../../components/chat/ChatWindow';

export function getStaticPaths() {
  return getLanguagePaths();
}

const lang            = getLangFromUrl(Astro.url);
const translationData = await loadTranslations(lang);
const t               = useTranslations(translationData);

const breadcrumbItems = [
  { label: t('nav.home'),      href: getLocalizedPath('', lang) },
  { label: t('nav.community') },
];
---

<PageLayout
  title={t('seo.community.title')}
  description={t('seo.community.description')}
  robots="noindex, follow"
  breadcrumbs={breadcrumbItems}
>
  <div class="community-wrap">
    <ChatWindow translationData={translationData} client:load />
  </div>
</PageLayout>

<style>
  /* Cancel .page-content padding so the chat fills edge-to-edge */
  .community-wrap {
    margin: -0.5rem -2rem -2rem;
    width: calc(100% + 4rem);
  }

  @media (max-width: 768px) {
    .community-wrap {
      margin: -0.5rem -1rem -3rem;
      width: calc(100% + 2rem);
    }
  }
</style>

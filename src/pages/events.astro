---
import PageLayout from '../layouts/PageLayout.astro';
import { useTranslations } from '../i18n/utils';
import EventCard from '../components/EventCard.astro';
import EventCountdown from '../components/EventCountdown';
import { events } from '../data/events';
import '../components/EventCountdown.css';

const t = useTranslations('de');

const upcomingEvents = events.filter(e => e.status === 'upcoming').sort((a, b) => a.date.getTime() - b.date.getTime());
const ongoingEvents = events.filter(e => e.status === 'ongoing');
const completedEvents = events.filter(e => e.status === 'completed').sort((a, b) => b.date.getTime() - a.date.getTime());

const nextEvent = upcomingEvents[0];
---

<PageLayout title={`${t('events.title')} - Wild Hoggs`} description="Guild events and activities">
  <div class="page-header">
    <h1>{t('events.title')}</h1>
    <p class="subtitle">Koordiniere dich mit der Gilde</p>
  </div>

  {nextEvent && <EventCountdown event={nextEvent} lang="de" client:load />}

  {ongoingEvents.length > 0 && (
    <section class="events-section">
      <h2>Laufende Events</h2>
      <div class="events-grid">
        {ongoingEvents.map(event => <EventCard event={event} lang="de" />)}
      </div>
    </section>
  )}

  <section class="events-section">
    <h2>{t('events.upcoming')}</h2>
    <div class="events-grid">
      {upcomingEvents.map(event => <EventCard event={event} lang="de" />)}
    </div>
  </section>

  {completedEvents.length > 0 && (
    <section class="events-section">
      <h2>Vergangene Events</h2>
      <div class="events-grid">
        {completedEvents.map(event => <EventCard event={event} lang="de" />)}
      </div>
    </section>
  )}
</PageLayout>

<style>
  .page-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  h1 {
    font-size: 2.5rem;
    color: #ffa500;
    margin-bottom: 0.5rem;
  }

  .subtitle {
    font-size: 1.2rem;
    color: rgba(255, 255, 255, 0.7);
  }

  .events-section {
    margin-bottom: 3rem;
  }

  .events-section h2 {
    color: #ffa500;
    margin-bottom: 1.5rem;
    font-size: 1.8rem;
  }

  .events-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 1.5rem;
  }

  @media (max-width: 768px) {
    h1 {
      font-size: 2rem;
    }

    .subtitle {
      font-size: 1rem;
    }

    .events-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
